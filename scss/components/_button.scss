//--------------------------------------------------
// CONFIGURATION
//--------------------------------------------------

//---------- Config: Via SCSS Maps
$shilp-button-defaults: () !default;
$shilp-button-defaults: map-merge(
  (
    "colors": shilp-color-names(),
    "themes": (
      trn,
      solid,
      outline,
      muted,
      gradient,
      tab
    ),
    "theme": "solid",
    "muted-shade": "lightest",
    "hover-shade": "darker",
    "radius": "4px"
  ),
  $shilp-button-defaults
);

//---------- Config: Via CSS Vars
$shilp-button-vars: () !default;
$shilp-button-vars: map-merge(
  (
    "bg": transparent,
    "color": --color(dark),
    "hover-bg": transparent,
    "hover-color": --color(dark),
    "border": 0px,
    "size": --field(md),
    "font-size": --field-text(md),
    "icon-size": --field-icon(md),
    "radius": 0px
  ),
  $shilp-button-vars
);

//---------- Local Variables
$button-colors: map-get($shilp-button-defaults, "colors");
$button-themes: map-get($shilp-button-defaults, "themes");
$button-hover-shade: map-get($shilp-button-defaults, "hover-shade");
$button-muted-shade: map-get($shilp-button-defaults, "muted-shade");
$default-button-theme: map-get($shilp-button-defaults, "theme");
$default-button-radius: map-get($shilp-button-defaults, "radius");

//--------------------------------------------------
// FUNCTIONS
//--------------------------------------------------

//--------------------------------------------------
// MIXINS
//--------------------------------------------------

//---------- THEME: SWITCHER
@mixin button-theme($theme, $color) {
  $default: --color($color);
  $text: "";
  $hover: "";
  $muted: "";

  @if ($color== "light" or $color== "dark") {
    $hover: --color($color);
    $muted: --color($color);
  } @else {
    $hover: --color($color, $button-hover-shade);
    $muted: --color($color, $button-muted-shade);
  }

  @if ($color== "light") {
    $text: --color(dark);
  } @else {
    $text: --color(light);
  }

  //---------- SOLID
  @if $theme== "solid" {
    --button--bg: #{$default};
    --button--color: #{$text};
    --button--hover-color: #{$text};
    --button--hover-bg: #{$hover};
  }
  //---------- OUTLINE
  @else if $theme== "outline" {
    --button--color: #{$default};
    --button--hover-color: #{$default};
    --button--hover-bg: #{$muted};
  }
  //---------- MUTED
  @else if $theme== "muted" {
    --button--bg: #{$muted};
    --button--color: #{$default};
    --button--hover-color: #{$text};
  }
  //----------  TRANSPARENT
  @else if $theme== "trn" {
    --button--color: #{$default};
    --button--hover-color: #{$hover};
    --button--bg: transparent;
    --button--hover-bg: transparent;
  }
  //---------- GRADIENT
  @else if $theme== "gradient" {
    background: create-gradient($color);
  }
  //----------  TAB
  @else if $theme== "tab" {
    &.button--active {
      --button--color: #{$default};
      --button--hover-color: #{$default};
      --button--bg: #{$default};
      --button--hover-bg: #{$default};
    }
  }
}

//--------------------------------------------------
// CSS BLOCK & ELEMENTS
//--------------------------------------------------
.button,
.button-group {
  @include component-vars("button", $shilp-button-vars);
}
.button {
  @include button--reset;
  display: inline-flex;
  align-items: center;
  white-space: nowrap;
  font-family: --text(content);
  text-decoration: none;
  line-height: 1;
  justify-content: center;
  background-color: var(--button--bg);
  color: var(--button--color);
  border: var(--button--border) solid var(--button--color);
  height: var(--button--size);
  padding: 0px calc(var(--button--size) / 2);
  font-size: var(--button--font-size);
  border-radius: var(--button--radius);
  svg {
    height: var(--button--icon-size) !important;
    width: var(--button--icon-size) !important;
  }
  path {
    fill: currentColor;
  }

  &:hover {
    text-decoration: none;
    &:not(:disabled) {
      color: var(--button--hover-color);
      background-color: var(--button--hover-bg);
    }
  }

  &:disabled {
    cursor: not-allowed;
    opacity: 0.8;
  }

  // Button in loading state
  &.loader {
    span,
    .button__icon {
      visibility: hidden;
    }
  }
}

.button__icon {
  display: flex;
  justify-content: center;
  align-items: center;
  @include margin(right, --space(2));
}

label.button {
  cursor: default;
  pointer-events: none;
}

//--------------------------------------------------
// MODIFIERS
//--------------------------------------------------
.button--fluid {
  width: 100% !important;
}
.button--link {
  padding: 0;
  height: auto;
}

//----------  ALIGNMENTS
.button--left {
  justify-content: flex-start;
  .button__icon {
    margin-right: --space(2);
  }
}
.button--right {
  flex-direction: row-reverse;
  justify-content: space-between;
  .button__icon {
    margin-left: --space(2);
    margin-right: 0;
  }
}

//----------  COLORS
// Generates classes for button colors.
// Uses default theme value.
@each $color, $value in $button-colors {
  .button--#{$color} {
    @include button-theme($default-button-theme, $color);
  }
}

//----------  theme & COLOR CLASSES
// Generates classes for button themes & colors.
@each $theme in $button-themes {
  @each $color, $value in $shilp-colors {
    .button--#{$color}.button--#{$theme} {
      @include button-theme($theme, $color);
    }
  }
}

//----------  SIZES
@each $key, $value in $shilp-field-sizes {
  .button--#{$key} {
    --button--size: #{--field($key)};
    --button--font-size: #{--field-text($key)};
    --button--icon-size: #{map-get($shilp-field-icon-sizes, $key)};
  }
}

//---------- themes
//OUTLINE
.button--outline {
  --button--border: 1px;
  --button--bg: transparent;
}

//TAB
.button--tab {
  --button--color: #{--color(grey)};
  --button--hover-color: #{--color(grey)};
  --button--bg: #{--color(grey, lighter)};
  --button--hover-bg: #{--color(grey, lighter)};
  position: relative;
  background-color: transparent;
  color: var(--button--color);
  &:after {
    content: "";
    @include position(absolute, auto, 0, 0, 0);
    height: 2px;
    background-color: var(--button--color);
    display: none;
  }
  &:hover:not(:disabled) {
    background-color: transparent;
    --button--hover-color: #{--color(primary)};
  }
  &.button--active {
    --button--color: #{--color(primary)};
    --button--hover-color: #{--color(primary)};
    background: transparent;
    &:after {
      display: block;
    }
  }
}

//----------  SHAPES
.button--square,
.button--circle {
  padding: 0 !important;
  justify-content: center;
  width: var(--button--size);
  .button__icon {
    margin: 0;
  }
}
.button--circle {
  --button--radius: 50%;
}
.button--rectangle {
  --button--radius: 0px;
}
.button--rounded {
  --button--radius: #{$default-button-radius};
}
.button--pill {
  --button--radius: 9999px;
}
